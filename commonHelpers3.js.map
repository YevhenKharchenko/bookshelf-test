{"version":3,"file":"commonHelpers3.js","sources":["../src/js/shopping-list.js"],"sourcesContent":["import axios from 'https://cdn.skypack.dev/axios';\nimport Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.css';\n\nconst container = document.getElementById('tui-pagination-container');\nconst instance = new Pagination(container);\n\ninstance.getCurrentPage();\n\n// Function to update the pagination\nfunction updatePagination() {\n  const totalPages = Math.ceil(totalItems / itemsPerPage);\n  const options = {\n    totalItems: totalItems,\n    itemsPerPage: itemsPerPage,\n    visiblePages: 10,\n    page: currentPage,\n    centerAlign: false,\n    firstItemClassName: 'tui-first-child',\n    lastItemClassName: 'tui-last-child',\n    template: {\n      page: '<a href=\"#\" class=\"tui-page-btn\">{{page}}</a>',\n      currentPage:\n        '<strong class=\"tui-page-btn tui-is-selected\">{{page}}</strong>',\n      moveButton:\n        '<a href=\"#\" class=\"tui-page-btn tui-{{type}}\"><span class=\"tui-ico-{{type}}\">{{type}}</span></a>',\n      disabledMoveButton:\n        '<span class=\"tui-page-btn tui-is-disabled tui-{{type}}\"><span class=\"tui-ico-{{type}}\">{{type}}</span></span>',\n      moreButton:\n        '<a href=\"#\" class=\"tui-page-btn tui-{{type}}-is-ellip\"><span class=\"tui-ico-ellip\">...</span></a>',\n    },\n  };\n  const pagination = new Pagination('pagination', options);\n}\n// Initial rendering\n// renderPage(currentPage); // стара функція\n// updatePagination();\n\n// Event listener for pagination change\n// document.getElementById('pagination').addEventListener('click', function (e) {\n//   if (e.target.classList.contains('tui-page-btn')) {\n//     currentPage = parseInt(e.target.textContent);\n//     renderPage(currentPage);\n//     updatePagination();\n//   }\n// });\n\nasync function getBooksAndAddToLocalStorage(array) {\n  const localStorageArray = [];\n\n  try {\n    // Use Promise.all to await all Axios requests concurrently\n    await Promise.all(\n      array.map(async id => {\n        const url = `https://books-backend.p.goit.global/books/${id}`;\n        const response = await axios.get(url);\n        localStorageArray.push(response.data); // Push entire book object to the array\n      })\n    );\n\n    // Convert the array to a string before storing it in local storage\n    localStorage.setItem('booksArray', JSON.stringify(localStorageArray));\n  } catch (error) {\n    console.error('Error fetching books:', error);\n    // Optionally, you can handle the error here, e.g., display an error message to the user\n    iziToast.error({\n      title: 'Error',\n      message: `Oops! Something went wrong while fetching books. Please try again later or contact support if the issue persists.`,\n      position: 'topRight',\n    });\n  }\n}\n\nconst booksToFetch = [\n  '643282b1e85766588626a0dc',\n  '643282b1e85766588626a080',\n  '643282b1e85766588626a0b2',\n  '643282b1e85766588626a086',\n  '643282b1e85766588626a085',\n];\n\n// getBooksAndAddToLocalStorage(booksToFetch);\n\n// ===================== Get from local storage ========================================================================\n\nconst shoppingList = document.querySelector('.shopping-list');\n// const placeholder = document.querySelector('.shop-list-placeholder');\nconst localStorageItems = JSON.parse(localStorage.getItem('booksArray')) || [];\n\n// Рендер Shopping list без реквеста на сервер\nexport function renderShoppingListFromLocalStorage() {\n  // const localStorageItems = JSON.parse(localStorage.getItem('booksArray')) || [];\n  try {\n    if (!localStorageItems) return;\n    localStorageItems.forEach(book =>\n      renderBookFromLocalStorageWithoutFetch(book)\n    );\n  } catch (error) {\n    console.log(error);\n    iziToast.error({\n      title: 'Error',\n      message: `Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${error.message}`,\n      position: 'topRight',\n    });\n  }\n}\n\n// Рендер книги без реквеста на сервер\nexport function renderBookFromLocalStorageWithoutFetch(book) {\n  const markup = `<li class=\"shopping-list-item\" data-id=\"${book._id}\">\n\n        <button type=\"button\" class=\"delete-btn\" title=\"Delete\"> \n        <div class=\"delete-btn-icon\"> </div> </div> </button> \n\n        <div class=\"shopping-list-div-image\"> <img class=\"shopping-list-image\" src=\"${book.book_image}\" alt=\"${book.title}\"> </div> \n\n        <div class=\"shopping-list-text\"> <h2 class=\"shopping-list-item-header\">${book.title}</h2>\n        \n        <p class=\"shopping-list-item-category\">${book.list_name}</p> \n        <div class=\"description-wrapper\"><p class=\"shopping-list-item-description\">${book.description}</p></div>\n        \n        <div class=\"link-container\"> \n        <p class=\"shopping-list-item-author\">${book.author}</p>\n        <div class=\"\"link-wrapper>\n            <a class=\"amazon-icon\" href=\"${book.amazon_product_url}\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"> <div class=\"amazon-logo hover-items-amaz-books\"> <img src=\"./png/amazon-1x.png\" alt=\"Amazon\" />\n            </div> </a>\n            <a class=\"apple-icon\" href=\"${book.buy_links[1].url}\" target=\"_blank\" rel=\"noopener noreferrer nofollow\"> <div class=\"apple-books-logo hover-items-amaz-books\">\n            <img src=\"./png/amazon-book-1x.png\" alt=\"Apple book\"/>\n            </div> </a>\n        </div>\n        </div>\n        </div>\n        </li>`;\n  shoppingList.insertAdjacentHTML('beforeend', markup);\n}\n\nrenderShoppingListFromLocalStorage();\n\n// function toggleVisibility() {\n//   if (localStorageItems.length === 0) {\n//     placeholder.style.display = 'block'; // Display placeholder if no items left\n//   } else {\n//     placeholder.style.display = 'none'; // Hide placeholder if items exist\n//   }\n// }\n\n// toggleVisibility();\n\n// const deleteBtn = document.querySelector('.delete-btn');\n\nconst deleteBtns = document.querySelectorAll('.delete-btn');\n\ndeleteBtns.forEach(btn => {\n  btn.addEventListener('click', onRemoveFromShoppingList);\n});\n\nfunction onRemoveFromShoppingList(e) {\n  const btn = e.currentTarget; // Current button clicked\n  const listItem = btn.closest('.shopping-list-item'); // Find the closest shopping list item\n  const id = listItem.dataset.id; // Get the ID from the data attribute\n  const updatedItems = localStorageItems.filter(item => item._id !== id); // Filter out the item with matching ID\n  localStorage.setItem('booksArray', JSON.stringify(updatedItems)); // Update local storage\n  listItem.remove(); // Remove the list item from the DOM\n\n  // Update localStorageItems array\n  const index = localStorageItems.findIndex(item => item._id === id);\n  localStorageItems.splice(index, 1);\n\n  // Check if updatedItems array is empty and remove the entire array from local storage if it is\n  if (updatedItems.length === 0) {\n    localStorage.removeItem('booksArray');\n  }\n\n  toggleVisibility();\n}\n"],"names":["container","instance","Pagination","shoppingList","localStorageItems","renderShoppingListFromLocalStorage","book","renderBookFromLocalStorageWithoutFetch","error","markup","deleteBtns","btn","onRemoveFromShoppingList","e","listItem","id","updatedItems","item","index"],"mappings":"qLAIA,MAAMA,EAAY,SAAS,eAAe,0BAA0B,EAC9DC,EAAW,IAAIC,EAAWF,CAAS,EAEzCC,EAAS,eAAc,EA8EvB,MAAME,EAAe,SAAS,cAAc,gBAAgB,EAEtDC,EAAoB,KAAK,MAAM,aAAa,QAAQ,YAAY,CAAC,GAAK,GAGrE,SAASC,GAAqC,CAEnD,GAAI,CACF,GAAI,CAACD,EAAmB,OACxBA,EAAkB,QAAQE,GACxBC,EAAuCD,CAAI,CACjD,CACG,OAAQE,EAAO,CACd,QAAQ,IAAIA,CAAK,EACjB,SAAS,MAAM,CACb,MAAO,QACP,QAAS,+GAA+GA,EAAM,OAAO,GACrI,SAAU,UAChB,CAAK,CACF,CACH,CAGO,SAASD,EAAuCD,EAAM,CAC3D,MAAMG,EAAS,2CAA2CH,EAAK,GAAG;AAAA;AAAA;AAAA;AAAA;AAAA,sFAKkBA,EAAK,UAAU,UAAUA,EAAK,KAAK;AAAA;AAAA,iFAExCA,EAAK,KAAK;AAAA;AAAA,iDAE1CA,EAAK,SAAS;AAAA,qFACsBA,EAAK,WAAW;AAAA;AAAA;AAAA,+CAGtDA,EAAK,MAAM;AAAA;AAAA,2CAEfA,EAAK,kBAAkB;AAAA;AAAA,0CAExBA,EAAK,UAAU,CAAC,EAAE,GAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAO7DH,EAAa,mBAAmB,YAAaM,CAAM,CACrD,CAEAJ,IAcA,MAAMK,EAAa,SAAS,iBAAiB,aAAa,EAE1DA,EAAW,QAAQC,GAAO,CACxBA,EAAI,iBAAiB,QAASC,CAAwB,CACxD,CAAC,EAED,SAASA,EAAyBC,EAAG,CAEnC,MAAMC,EADMD,EAAE,cACO,QAAQ,qBAAqB,EAC5CE,EAAKD,EAAS,QAAQ,GACtBE,EAAeZ,EAAkB,OAAOa,GAAQA,EAAK,MAAQF,CAAE,EACrE,aAAa,QAAQ,aAAc,KAAK,UAAUC,CAAY,CAAC,EAC/DF,EAAS,OAAM,EAGf,MAAMI,EAAQd,EAAkB,UAAUa,GAAQA,EAAK,MAAQF,CAAE,EACjEX,EAAkB,OAAOc,EAAO,CAAC,EAG7BF,EAAa,SAAW,GAC1B,aAAa,WAAW,YAAY,EAGtC,kBACF"}