import"./assets/modulepreload-polyfill-3cfb730f.js";import{a as p,i as g}from"./assets/vendor-e8675f53.js";class k{constructor(){this.BASE_URL="https://books-backend.p.goit.global/books",this.CATEGORY_LIST="/category-list",this.TOP_BOOKS="/top-books",this.CATEGORY="/category?category="}async getCategories(){const t=this.BASE_URL+this.CATEGORY_LIST;try{return(await p.get(t)).data}catch(o){console.log(o),iziToast.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${o.message}`,position:"topRight"})}}async getTopBooks(){const t=this.BASE_URL+this.TOP_BOOKS;try{return(await p.get(t)).data}catch(o){console.log(o),iziToast.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${o.message}`,position:"topRight"})}}async getCategory(t){const o=this.BASE_URL+this.CATEGORY+t;try{return(await p.get(o)).data}catch(r){console.log(r),iziToast.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${r.message}`,position:"topRight"})}}async getBook(t){const o=this.BASE_URL+"/"+t;try{return(await p.get(o)).data}catch(r){console.log(r),iziToast.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${r.message}`,position:"topRight"})}}}const u=new k,h=document.querySelector(".categories-list"),a=document.querySelector(".category");document.querySelector(".shopping-list");const c=JSON.parse(localStorage.getItem("books"))||[];async function $(){try{const t=(await u.getCategories()).map(({list_name:o})=>`<a class="category-link" href=""><li>${o}</li></a>`).join("");h.insertAdjacentHTML("beforeend",t)}catch(e){console.log(e),g.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${e.message}`,position:"topRight"})}}async function S(){try{(await u.getTopBooks()).forEach(t=>{const o=`<h2>${t.list_name}</h2>`,r=`<button class="category-btn" data-category="${t.list_name}" type="button">See more</button>`,i=t.books.map(n=>`
        <div class="book" id="${n._id}">
          <img src="${n.book_image}" alt="${n.title}">
          <h3>${n.title}</h3>
          <p class="description">${n.description}</p>
          <p class="author">Author: ${n.author}</p>
          <p class="publisher"=>Publisher: ${n.publisher}</p>
          <a class="amazon-link" href="${n.amazon_product_url}" target="_blank">Buy on Amazon</a>
        </div>`).join(""),s=o+r+i;a.insertAdjacentHTML("beforeend",s)})}catch(e){console.log(e),g.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${e.message}`,position:"topRight"})}}async function d(e){try{const t=await u.getCategory(e),o=`<h2>${e}</h2>`,r=t.map(s=>`
      <div class="book" id="${s._id}">
        <img src="${s.book_image}" alt="${s.title}">
        <h3>${s.title}</h3>
        <p class="description">${s.description}</p>
        <p class="author">Author: ${s.author}</p>
        <p class="publisher">Publisher: ${s.publisher}</p>
        <a class="amazon-link" href="${s.amazon_product_url}" target="_blank">Buy on Amazon</a>
      </div>`).join(""),i=o+r;a.insertAdjacentHTML("beforeend",i)}catch(t){console.log(t),g.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${t.message}`,position:"topRight"})}}async function _(e){try{const t=await u.getBook(e);let o="Add to shopping list";c.findIndex(i=>i._id===t._id)>-1&&(o="Remove from shopping list");const r=`
  <li class="book" id="${t._id}">
    <img src="${t.book_image}" alt="${t.title}">
    <h3>${t.title}</h3>
    <p class="description">${t.description}</p>
    <p class="author">Author: ${t.author}</p>
    <p class="publisher">Publisher: ${t.publisher}</p>
    <a class="amazon-link" href="${t.amazon_product_url}" target="_blank">Buy on Amazon</a>
    <button class="add-btn" type="button">${o}</button>
  </li>`;a.insertAdjacentHTML("beforeend",r)}catch(t){console.log(t),g.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${t.message}`,position:"topRight"})}}function E(e){e.preventDefault(),a.innerHTML="";const t=e.target.textContent;d(t)}function T(e){if(!e.target.classList.contains("category-btn"))return;const t=e.target.dataset.category;a.innerHTML="",d(t)}function w(e){if(e.target.nodeName!=="IMG")return;e.preventDefault(),e.stopPropagation();const t=e.target.parentNode.id;a.innerHTML="",_(t)}async function A(e){const t=e.target.closest(".book");if(!t)return;const o=t.id,r=t.querySelector("h3").textContent,i=t.querySelector(".description").textContent,s=t.querySelector(".author").textContent,n=t.querySelector(".publisher").textContent,m=t.querySelector("img").src,y=t.querySelector(".amazon-link").href,f={_id:o,title:r,description:i,author:s,publisher:n,book_image:m,amazon_product_url:y};if(e.target.textContent==="Add to shopping list"){if(c.find(l=>l._id===o))return;e.target.textContent="Remove from shopping list",c.push(f),localStorage.setItem("books",JSON.stringify(c))}else if(e.target.textContent==="Remove from shopping list"){const l=c.findIndex(b=>b._id===o);l!==-1&&(c.splice(l,1),localStorage.setItem("books",JSON.stringify(c)),e.target.textContent="Add to shopping list")}}h.addEventListener("click",E);a.addEventListener("click",T);a.addEventListener("click",w);a.addEventListener("click",A);$();S();
//# sourceMappingURL=commonHelpers.js.map
