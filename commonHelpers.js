import{a as p,i as l}from"./assets/vendor-db25513e.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(s){if(s.ep)return;s.ep=!0;const r=o(s);fetch(s.href,r)}})();class m{constructor(){this.BASE_URL="https://books-backend.p.goit.global/books",this.CATEGORY_LIST="/category-list",this.TOP_BOOKS="/top-books",this.CATEGORY="/category?category="}async getCategories(){const t=this.BASE_URL+this.CATEGORY_LIST;try{return(await p.get(t)).data}catch(o){console.log(o),iziToast.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${o.message}`,position:"topRight"})}}async getTopBooks(){const t=this.BASE_URL+this.TOP_BOOKS;try{return(await p.get(t)).data}catch(o){console.log(o),iziToast.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${o.message}`,position:"topRight"})}}async getCategory(t){const o=this.BASE_URL+this.CATEGORY+t;try{return(await p.get(o)).data}catch(n){console.log(n),iziToast.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${n.message}`,position:"topRight"})}}async getBook(t){const o=this.BASE_URL+"/"+t;try{return(await p.get(o)).data}catch(n){console.log(n),iziToast.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${n.message}`,position:"topRight"})}}}const g=new m,u=document.querySelector(".categories-list"),c=document.querySelector(".category"),d=document.querySelector(".shopping-list"),a=JSON.parse(localStorage.getItem("books"))||[];async function f(){try{const t=(await g.getCategories()).map(({list_name:o})=>`<a class="category-link" href=""><li>${o}</li></a>`).join("");u.insertAdjacentHTML("beforeend",t)}catch(e){console.log(e),l.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${e.message}`,position:"topRight"})}}async function y(){try{(await g.getTopBooks()).forEach(t=>{const o=`<h2>${t.list_name}</h2>`,n=`<button class="category-btn" data-category="${t.list_name}" type="button">See more</button>`,s=t.books.map(i=>`
        <div class="book" id="${i._id}">
          <img src="${i.book_image}" alt="${i.title}">
          <h3>${i.title}</h3>
          <p>Author: ${i.author}</p>
          <p>Publisher: ${i.publisher}</p>
          <a href="${i.amazon_product_url}" target="_blank">Buy on Amazon</a>
        </div>`).join(""),r=o+n+s;c.insertAdjacentHTML("beforeend",r)})}catch(e){console.log(e),l.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${e.message}`,position:"topRight"})}}async function h(e){try{const t=await g.getCategory(e),o=`<h2>${e}</h2>`,n=t.map(r=>`
      <div class="book" id="${r._id}">
        <img src="${r.book_image}" alt="${r.title}">
        <h3>${r.title}</h3>
        <p>Author: ${r.author}</p>
        <p>Publisher: ${r.publisher}</p>
        <a href="${r.amazon_product_url}" target="_blank">Buy on Amazon</a>
      </div>`).join(""),s=o+n;c.insertAdjacentHTML("beforeend",s)}catch(t){console.log(t),l.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${t.message}`,position:"topRight"})}}async function $(e){try{const t=await g.getBook(e),o=`
  <li id="${t._id}">
    <img src="${t.book_image}" alt="${t.title}">
    <h3>${t.title}</h3>
    <p>Author: ${t.author}</p>
    <p>Publisher: ${t.publisher}</p>
    <a href="${t.amazon_product_url}" target="_blank">Buy on Amazon</a>
    <button type="button">Add to shopping list</button>
  </li>`;c.insertAdjacentHTML("beforeend",o)}catch(t){console.log(t),l.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${t.message}`,position:"topRight"})}}function b(e){e.preventDefault(),c.innerHTML="";const t=e.target.textContent;h(t)}function S(e){if(!e.target.classList.contains("category-btn"))return;const t=e.target.dataset.category;c.innerHTML="",h(t)}function O(e){if(e.target.nodeName!=="IMG")return;e.preventDefault(),e.stopPropagation();const t=e.target.parentNode.id;c.innerHTML="",$(t)}function E(e){if(e.target.textContent==="Add to shopping list"){const t=e.target.parentNode.id;if(a.includes(t))return;e.target.textContent="Remove from shopping list",a.push(t),localStorage.setItem("books",JSON.stringify(a));return}if(e.target.textContent==="Remove from shopping list"){const t=e.target.parentNode.id,o=a.indexOf(t);if(o!==-1){a.splice(o,1),localStorage.setItem("books",JSON.stringify(a)),e.target.textContent="Add to shopping list";return}}}function L(){try{const e=JSON.parse(localStorage.getItem("books"));if(!e)return;e.forEach(t=>k(t))}catch(e){console.log(e),l.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${e.message}`,position:"topRight"})}}async function k(e){try{const t=await g.getBook(e),o=`
  <li id="${t._id}">
    <img src="${t.book_image}" alt="${t.title}">
    <h3>${t.title}</h3>
    <p>Author: ${t.author}</p>
    <p>Publisher: ${t.publisher}</p>
    <a href="${t.amazon_product_url}" target="_blank">Buy on Amazon</a>
    <button type="button">Remove from shopping list</button>
  </li>`;d.insertAdjacentHTML("beforeend",o)}catch(t){console.log(t),l.error({title:"Error",message:`Oops! Something went wrong. Please try again later or contact support if the issue persists. Error details: ${t.message}`,position:"topRight"})}}function w(e){if(e.target.nodeName!=="BUTTON")return;const t=e.target.parentNode,o=t.id,n=a.indexOf(o);a.splice(n,1),localStorage.setItem("books",JSON.stringify(a)),t.remove()}u.addEventListener("click",b);c.addEventListener("click",S);c.addEventListener("click",O);c.addEventListener("click",E);d.addEventListener("click",w);f();y();L();
//# sourceMappingURL=commonHelpers.js.map
